[![Django-app-workflow](https://github.com/ARDineev/yamdb_final/actions/workflows/yamdb_workflow.yml/badge.svg)](https://github.com/ARDineev/yamdb_final/actions/workflows/yamdb_workflow.yml)  
# Проект «YaMDb»
### Описание
Проект YaMDb собирает отзывы (Review) пользователей на произведения (Titles).  
Произведения делятся на категории: «Книги», «Фильмы», «Музыка».  
Сами произведения в YaMDb не хранятся, здесь нельзя посмотреть фильм или послушать музыку.  
В каждой категории есть конкретные произведения: книги, фильмы или музыка.  
Произведению может быть присвоен жанр (Genre) из списка предустановленных  
(например, «Сказка», «Рок» или «Артхаус»).  
Пользователи оставляют к произведениям текстовые отзывы (Review) и ставят произведению оценку  
в диапазоне от одного до десяти (целое число);  
из пользовательских оценок формируется усреднённая оценка произведения — рейтинг (целое число).  
**Предусмотрены следующие пользовательские роли:**  
**Аноним** — может просматривать описания произведений, читать отзывы и комментарии.  
**Аутентифицированный пользователь (user)** — может, как и Аноним, читать всё,  
дополнительно он может публиковать отзывы и ставить оценку произведениям (фильмам/книгам/песенкам),  
может комментировать чужие   отзывы; может редактировать и удалять свои отзывы и комментарии.  
Эта роль присваивается по умолчанию каждому новому пользователю.  
**Модератор (moderator)** — те же права, что и у Аутентифицированного пользователя плюс право удалять  
любые отзывы и комментарии.  
**Администратор (admin)** — полные права на управление всем контентом проекта.  
Может создавать и удалять произведения, категории и жанры. Может назначать роли пользователям.  
**Суперюзер Django** — обладет правами администратора (admin)  
### Технологии
- **Python 3.7**
- **Django 2.2.16**
- **Django Rest Framework 3.12.4**
- **SimpleJWT 4.8.0**
- **Docker**
### Как запустить проект на сервере:  
1. Подготовить сервер: установить на него docker и утилиту docker-compose; скопируйте файлы docker-compose.yaml  
и nginx/default.conf из данного проекта на сервер в home/<ваш_username>/docker-compose.yaml и  
home/<ваш_username>/nginx/default.conf соответственно  
2. Создайте в домашней директории сервера файл .env и заполните его по шаблону:  
DB_ENGINE=(тип СУБД) # указываем, с каким типом БД работаем (в проекте используется postgresql)  
DB_NAME=(имя базы данных) # надо будет создать свою БД в postgres и указать ее имя  
POSTGRES_USER=(логин юзера БД) # надо будет зарегистрировать своего юзера в postgres и указать его имя  
под этим логином Джанго-проект будет обращаться к БД  
POSTGRES_PASSWORD=(пароль юзера БД) # пароль для подключения зарегистрированного юзера к БД  
DB_HOST=(название сервиса, контейнера) # указать имя контейнера - db  
DB_PORT=(порт для подключения к БД) # указать порт, рекомендуется 5432  
SECRET_KEY=(секретный ключ Джанго) # придумайте или сгенерируйте уникальный ключ (необходим для криптографичесокй подписи)  
3. Собрать контейнеры и запустить их командой:  
```
sudo docker-compose up -d
```
4. Выполнить по очереди команды:  
```
sudo docker-compose exec web python manage.py migrate
```
```
sudo docker-compose exec web python manage.py collectstatic --no-input
```
5. Теперь проект доступен по адресу: http://ip_servera/  
### Примеры работы с проектом
**Алгоритм регистрации пользователей**  
1.Пользователь отправляет POST-запрос на добавление нового пользователя с параметрами email и username на эндпоинт /api/v1/auth/signup/.
2.YaMDB отправляет письмо с кодом подтверждения (confirmation_code) на адрес email.
3.Пользователь отправляет POST-запрос с параметрами username и confirmation_code на эндпоинт /api/v1/auth/token/, в ответе на запрос ему приходит token (JWT-токен).
4.При желании пользователь отправляет PATCH-запрос на эндпоинт /api/v1/users/me/ и заполняет поля в своём профайле.  
*Примеры:*
*При POST запросе на эндпоинт /api/v1/auth/signup/ с таким содержимым:*  
*{*  
*"email": "string",*  
*"username": "string"*  
*}*  
*Будет отправлен confirmation_code на адрес email и получен ответ со статусом 200.*  
*Далее необходимо подтвердить регистрацию. При POST запросе на эндпоинт /api/v1/auth/token/ с таким содержимым:*  
*{*  
*"username": "string",*  
*"confirmation_code": "string"*  
*}*  
*В ответ будет получен jwt-токен:*  
*{*  
*"token": "string",*  
*}*  
**Работа с категориями**  
Любой пользователь может посмотреть список категорий, отправив GET-запрос на эндпоинт /api/v1/categories/  
В ответ придет *пагинированный* перечень:  
*{*  
*"name": "string",*  
*"slug": "string"*  
*}*  
Добавить категорию может только администратор, отправив следующий POST-запрос на эндпоинт /api/v1/categories/:  
*{*  
*"name": "string",*  
*"slug": "string"*  
*}*  
Администратор также может удалить категорию, отправив соответствующий запрос на эндпоинт /api/v1/categories/{slug}/  
**Работа с жанрами**  
Любой пользователь может посмотреть список жанров, отправив GET-запрос на эндпоинт /api/v1/genres/  
В ответ придет *пагинированный* перечень:  
*{*  
*"name": "string",*  
*"slug": "string"*  
*}*  
Добавить жанр может только администратор, отправив следующий POST-запрос на эндпоинт /api/v1/genres/:  
*{*  
*"name": "string",*  
*"slug": "string"*  
*}*  
Администратор также может удалить жанр, отправив соответствующий запрос на эндпоинт /api/v1/genres/{slug}/  
**Для более подробного описания перейдите по ссылке http://51.250.31.12/redoc/**  
### Ссылка на уже развернутый проект: http://51.250.31.12/admin/  
### Авторы
Валентин Корзюк, Александр Богус и Динеев Артур. Работа с контейнерами, разворачивание на боевом сервере - Динеев Артур  